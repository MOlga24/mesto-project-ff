(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p:""};e.d({},{oS:()=>z,XX:()=>w});var t={baseUrl:"https://nomoreparties.co/v1/wff-cohort-22",headers:{authorization:"3bdecd97-cc83-4e5e-ac8d-e22694049ffd","Content-Type":"application/json"}};function o(e,o,n){!function(e,o,n){fetch("".concat(t.baseUrl,"/cards/likes/").concat(n),{method:"PUT",headers:{authorization:"3bdecd97-cc83-4e5e-ac8d-e22694049ffd","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e)})),e.nextElementSibling.textContent-=e.classList.toggle("card__like-button_is-active")?-1:1}(e,0,n)}var n=document.querySelector("#card-template").content,r=0;function c(e,o){!function(e,o){fetch("".concat(t.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:"3bdecd97-cc83-4e5e-ac8d-e22694049ffd","Content-Type":"application/json"}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)})),o.remove()}(o,e.closest(".card"))}function i(e,t,o,c){var i=n.querySelector(".card__image");i.setAttribute("alt",e.name),i.setAttribute("src",e.link);var a=n.querySelector(".places__item").cloneNode(!0);a.querySelector(".card__title").textContent=e.name,e._id,r=e.likes.length<1?0:e.likes.length;var u=a.querySelector(".card__like-button"),l=a.querySelector(".like__num");u.addEventListener("click",(function(){o(u,l,e._id)})),a.querySelector(".like__num").textContent=r;var s=a.querySelector(".card__delete-button");return s.addEventListener("click",(function(){t(s,e._id)})),a.querySelector(".card__image").addEventListener("click",c),a}function a(e){e.classList.add("popup_is-animated"),e.classList.add("popup_is-opened"),document.addEventListener("keydown",l)}function u(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",l)}function l(e){"Escape"===e.key&&u(document.querySelector(".popup_is-opened"))}function s(e){e.currentTarget===e.target&&u(e.currentTarget)}e.p;var d=".popup__form",p=".popup__input",f=".popup__button",_="popup__button_disabled",m="popup__input_type_error",y="popup__error_visible",v=".popup__error_visible";function h(){document.querySelectorAll(p).forEach((function(e){e.classList.remove(m)})),document.querySelectorAll(v).forEach((function(e){e.textContent="",e.classList.remove(y)}))}var S=function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(m),o.classList.remove(y),o.textContent=""}(e,t):function(e,t,o){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add(m),n.textContent=o,n.classList.add(y)}(e,t,t.validationMessage)},q=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.classList.remove(_),t.disabled=!1):(t.classList.add(_),t.disabled=!0)},b=document.querySelector(".popup_type_new-card"),g=document.querySelector(".profile__add-button"),E=document.querySelector(".popup_type_edit"),L=document.querySelector(".places__list"),k=document.querySelectorAll(".popup"),C=document.querySelector(".profile__edit-button"),A=document.querySelector(".popup_type_image"),j=A.querySelector(".popup__image"),x=document.querySelector(".profile__info");function T(){a(A);var e=A.querySelector(".popup__caption");j.src=this.src,e.textContent=this.alt}function w(e){L.textContent=" ",e.forEach((function(e){L.append(i(e,c,o,T))}))}function z(e,t){x.querySelector(".profile__title").textContent=e,x.querySelector(".profile__description").textContent=t,function(e,t){fetch("https://nomoreparties.co/v1/wff-cohort-22/users/me",{method:"PATCH",headers:{authorization:"3bdecd97-cc83-4e5e-ac8d-e22694049ffd","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})}(e,t)}document.forms.edit_profile.addEventListener("submit",(function(e){z(document.forms.edit_profile.elements.name.value,document.forms.edit_profile.elements.description.value),e.preventDefault(),u(E)})),document.forms.new_place.addEventListener("submit",(function(e){var t=b.querySelector(".popup__input_type_card-name").value,n=b.querySelector(".popup__input_type_url").value;e.preventDefault();var r=i({name:t,link:n,likes:0},c,o,T);(function(e,t){fetch("https://nomoreparties.co/v1/wff-cohort-22/cards",{method:"POST",headers:{authorization:"3bdecd97-cc83-4e5e-ac8d-e22694049ffd","Content-Type":"application/json"},body:JSON.stringify({name:e,link:t,likes:0})}).then((function(e){return e.json()})).then((function(e){console.log(e[t])}))})(t,n),L.prepend(r),u(b)})),document.addEventListener("click",(function(e){e.target===g&&(document.forms.new_place.reset(),h(),a(b)),e.target===C&&(h(),document.querySelector(".popup__input_type_name").value=x.querySelector(".profile__title").textContent,document.querySelector(".popup__input_type_description").value=x.querySelector(".profile__description").textContent,a(E))})),k.forEach((function(e){e.querySelector(".popup__close").addEventListener("click",(function(){u(e)}))})),k.forEach((function(e){e.addEventListener("click",s)})),fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){if(e.ok)return e.json()})).then((function(e){console.log(e),w(Array.from(e))})).catch((function(e){return Promise.reject("Ошибка: ".concat(e.status))})),fetch("https://nomoreparties.co/v1/wff-cohort-22/users/me",{headers:{authorization:"3bdecd97-cc83-4e5e-ac8d-e22694049ffd"}}).then((function(e){return e.json()})).then((function(e){document.querySelector(".profile__image").setAttribute("style","background-image: url(".concat(e.avatar,")")),z(e.name,e.about)})),Array.from(document.querySelectorAll(".popup")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(e.querySelectorAll(d)).forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll(p)),o=e.querySelector(f);q(t,o),t.forEach((function(n){n.addEventListener("input",(function(){q(t,o),S(e,n)}))}))}(e)}))}))})();